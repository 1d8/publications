# CVE-2021-29012 (Broken Session Management)

When an admin user logs in, their session cookie is given & doesn't expire upon logging out. Instead the session cookie is temporarily disabled until the admin logs in again. The session cookie doesn't change so if an attacker manages to steal a session cookie, then they can simply reuse it when the admin is logged in again and impersonate them. And if they aren't successful at logging in the first time due to the admin being logged out, they can simply keep trying until the admin is logged in again and get a successful login.

Successful exploitation requires that you have access to the Radius Management web interface and be able to make requests so you can simply change out the session cookie header when making HTTP requests.

This vulnerability can be exploited in order to elevate privileges when chained together with CVE-2021-29011 in order to gain the session cookie of another user with elevated privileges.

## Demo Videos

We simply swap an admin's cookie for a low privileged user's cookie and are able to assume the privileges of the admin as shown here:

[Dropbox - session-impersonation-2021-03-19_23.11.19.mkv](https://www.dropbox.com/s/9ootf6udj761bbh/session-impersonation-2021-03-19_23.11.19.mkv?dl=0)

The overall process that I went through to exploit this is:

1. Create an account with no privileges
  
2. Grab the admin session cookie
  
3. Make a request that requires privileges such as creating a user using the low privilege account
  
4. Request is denied due to no privileges
  
5. Resend the request but this time modify the cookie parameter so that it's replaced with the admin session cookie
  
6. Request is successful & we can now make requests on behalf of the admin user while the admin user is logged in.
